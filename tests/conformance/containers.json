{
  "type": "bonjson-test",
  "version": "1.0.0",
  "//": "Container (array and object) encoding tests",
  "tests": [
    {
      "//": "Array with different value types (3 elements: count=3, cont=0 ‚Üí 0x0c)",
      "name": "array_with_string_int_null",
      "type": "encode",
      "input": [
        "a",
        1,
        null
      ],
      "expected_bytes": "b3666101b0b5"
    },
    {
      "//": "Nested empty arrays (outer: 1 element ‚Üí 0x04, inner: 0 elements ‚Üí 0x00)",
      "name": "array_nested_empty",
      "type": "encode",
      "input": [
        []
      ],
      "expected_bytes": "b3b3b5b5"
    },
    {
      "//": "Array with nested object (array: 1 element ‚Üí 0x04, object: 1 pair ‚Üí 0x04)",
      "name": "array_with_object",
      "type": "encode",
      "input": [
        {
          "a": 1
        }
      ],
      "expected_bytes": "b3b4666101b5b5"
    },
    {
      "//": "Object with integer value (1 pair ‚Üí 0x04)",
      "name": "object_with_int",
      "type": "encode",
      "input": {
        "a": 1
      },
      "expected_bytes": "b4666101b5"
    },
    {
      "//": "Object with negative small int value (1 pair ‚Üí 0x04)",
      "name": "object_with_neg_int",
      "type": "encode",
      "input": {
        "a": -1
      },
      "expected_bytes": "b46661a9ffb5"
    },
    {
      "//": "Object with larger int value (requires int16) (1 pair ‚Üí 0x04)",
      "name": "object_with_int16",
      "type": "encode",
      "input": {
        "a": 1000
      },
      "expected_bytes": "b46661aae803b5"
    },
    {
      "//": "Object with int64 value (1 pair ‚Üí 0x04)",
      "name": "object_with_int64",
      "type": "encode",
      "input": {
        "a": 1152921504606846976
      },
      "expected_bytes": "b46661ac000000000000001095"
    },
    {
      "//": "Object with negative int64 value (1 pair ‚Üí 0x04)",
      "name": "object_with_neg_int64",
      "type": "encode",
      "input": {
        "a": -1152921504606846976
      },
      "expected_bytes": "b46661ac00000000000000f0b5"
    },
    {
      "//": "Object with float16 value (1 pair ‚Üí 0x04)",
      "name": "object_with_float16",
      "type": "encode",
      "input": {
        "a": 1.25
      },
      "expected_bytes": "b46661ad0000a03fb5"
    },
    {
      "//": "Object with float64 value (1 pair ‚Üí 0x04)",
      "name": "object_with_float64",
      "type": "encode",
      "input": {
        "a": -5.923441e-50
      },
      "expected_bytes": "b46661ae353cce818729b6b5b5"
    },
    {
      "//": "Object with string value (1 pair ‚Üí 0x04)",
      "name": "object_with_string",
      "type": "encode",
      "input": {
        "a": "b"
      },
      "expected_bytes": "b46661666295"
    },
    {
      "//": "Object with boolean false value (1 pair ‚Üí 0x04)",
      "name": "object_with_false",
      "type": "encode",
      "input": {
        "a": false
      },
      "expected_bytes": "b46661b1b5"
    },
    {
      "//": "Object with null value (1 pair ‚Üí 0x04)",
      "name": "object_with_null",
      "type": "encode",
      "input": {
        "a": null
      },
      "expected_bytes": "b46661b0b5"
    },
    {
      "//": "Object with nested empty object value (outer: 1 pair ‚Üí 0x04, inner: 0 pairs ‚Üí 0x00)",
      "name": "object_with_nested_object",
      "type": "encode",
      "input": {
        "a": {}
      },
      "expected_bytes": "b46661b4b5b5"
    },
    {
      "//": "Object with nested empty array value (object: 1 pair ‚Üí 0x04, array: 0 elements ‚Üí 0x00)",
      "name": "object_with_nested_array",
      "type": "encode",
      "input": {
        "a": []
      },
      "expected_bytes": "b46661b3b5b5"
    },
    {
      "//": "Array with multiple element types (3 elements ‚Üí 0x0c)",
      "name": "array_varied_elements",
      "type": "encode",
      "input": [
        "a",
        -1,
        "z"
      ],
      "expected_bytes": "b36661a9ff667ab5"
    },
    {
      "//": "Array with larger integers (3 elements ‚Üí 0x0c)",
      "name": "array_with_int16",
      "type": "encode",
      "input": [
        "a",
        1000,
        "z"
      ],
      "expected_bytes": "b36661aae803667ab5"
    },
    {
      "//": "Complex nested structure (roundtrip since key order is unspecified)",
      "name": "complex_nested_structure",
      "type": "roundtrip",
      "input": {
        "number": 50,
        "null": null,
        "boolean": true,
        "array": [
          "x",
          1000,
          -1.25
        ],
        "object": {
          "negative number": -100,
          "long string": "1234567890123456789012345678901234567890"
        }
      }
    },
    {
      "//": "Round-trip tests",
      "name": "roundtrip_nested_arrays",
      "type": "roundtrip",
      "input": [
        [
          1,
          2
        ],
        [
          3,
          4
        ]
      ]
    },
    {
      "name": "roundtrip_nested_objects",
      "type": "roundtrip",
      "input": {
        "outer": {
          "inner": 42
        }
      }
    },
    {
      "name": "roundtrip_mixed_nesting",
      "type": "roundtrip",
      "input": {
        "array": [
          1,
          {
            "nested": true
          }
        ],
        "value": null
      }
    },
    {
      "name": "roundtrip_deep_nesting",
      "type": "roundtrip",
      "input": {
        "a": {
          "b": {
            "c": {
              "d": {
                "e": 5
              }
            }
          }
        }
      }
    },
    {
      "//": "=== Object key edge cases ===",
      "name": "object_empty_string_key",
      "type": "roundtrip",
      "input": {
        "": 1
      }
    },
    {
      "//": "Empty string key with complex value",
      "name": "object_empty_string_key_array_value",
      "type": "roundtrip",
      "input": {
        "": [
          1,
          2,
          3
        ]
      }
    },
    {
      "//": "Long string key (16+ bytes uses long string encoding)",
      "name": "object_long_string_key",
      "type": "roundtrip",
      "input": {
        "this is a long key": 42
      }
    },
    {
      "//": "Very long key (32 bytes)",
      "name": "object_very_long_string_key",
      "type": "roundtrip",
      "input": {
        "12345678901234567890123456789012": "value"
      }
    },
    {
      "//": "Unicode object key - Japanese",
      "name": "object_unicode_key_japanese",
      "type": "roundtrip",
      "input": {
        "Êó•Êú¨Ë™û": "Japanese"
      }
    },
    {
      "//": "Unicode object key - Emoji",
      "name": "object_unicode_key_emoji",
      "type": "roundtrip",
      "input": {
        "üòÄ": "smiley"
      }
    },
    {
      "//": "Unicode object key - Mixed",
      "name": "object_unicode_key_mixed",
      "type": "roundtrip",
      "input": {
        "Hello ‰∏ñÁïå üåç": "mixed"
      }
    },
    {
      "//": "Multiple objects with various key types",
      "name": "object_mixed_key_types",
      "type": "roundtrip",
      "input": {
        "": 0,
        "a": 1,
        "this is a long key name": 2,
        "Êó•Êú¨": 3
      }
    },
    {
      "//": "Object key that looks like a number",
      "name": "object_numeric_string_key",
      "type": "roundtrip",
      "input": {
        "123": "numeric looking key"
      }
    },
    {
      "//": "Object key with spaces",
      "name": "object_key_with_spaces",
      "type": "roundtrip",
      "input": {
        "key with spaces": "value"
      }
    },
    {
      "//": "Nested objects with unicode keys",
      "name": "object_nested_unicode_keys",
      "type": "roundtrip",
      "input": {
        "Êó•Êú¨": {
          "Ë™û": {
            "value": 42
          }
        }
      }
    },
    {
      "//": "=== Empty container nesting tests ===",
      "//note": "Various patterns of nested empty containers"
    },
    {
      "//": "Array of empty arrays",
      "name": "array_of_empty_arrays",
      "type": "roundtrip",
      "input": [
        [],
        [],
        []
      ]
    },
    {
      "//": "Array of empty objects",
      "name": "array_of_empty_objects",
      "type": "roundtrip",
      "input": [
        {},
        {},
        {}
      ]
    },
    {
      "//": "Object with empty array values",
      "name": "object_with_empty_array_values",
      "type": "roundtrip",
      "input": {
        "a": [],
        "b": [],
        "c": []
      }
    },
    {
      "//": "Object with empty object values",
      "name": "object_with_empty_object_values",
      "type": "roundtrip",
      "input": {
        "a": {},
        "b": {},
        "c": {}
      }
    },
    {
      "//": "Deeply nested empty arrays",
      "name": "deeply_nested_empty_arrays",
      "type": "roundtrip",
      "input": [
        [
          [
            [
              [
                []
              ]
            ]
          ]
        ]
      ]
    },
    {
      "//": "Deeply nested empty objects",
      "name": "deeply_nested_empty_objects",
      "type": "roundtrip",
      "input": {
        "a": {
          "b": {
            "c": {
              "d": {
                "e": {}
              }
            }
          }
        }
      }
    },
    {
      "//": "Mixed empty containers",
      "name": "mixed_empty_containers",
      "type": "roundtrip",
      "input": {
        "arr": [],
        "obj": {},
        "nested": {
          "inner": []
        }
      }
    },
    {
      "//": "Alternating empty arrays and objects",
      "name": "alternating_empty_containers",
      "type": "roundtrip",
      "input": [
        {},
        [],
        {},
        [],
        {}
      ]
    },
    {
      "//": "Empty array encode verification (0 elements ‚Üí 0x00)",
      "name": "encode_empty_array",
      "type": "encode",
      "input": [],
      "expected_bytes": "b3b5"
    },
    {
      "//": "Empty object encode verification (0 pairs ‚Üí 0x00)",
      "name": "encode_empty_object",
      "type": "encode",
      "input": {},
      "expected_bytes": "b4b5"
    },
    {
      "//": "Nested empty array encode verification (outer: 1 element ‚Üí 0x04, inner: 0 elements ‚Üí 0x00)",
      "name": "encode_nested_empty_array",
      "type": "encode",
      "input": [
        []
      ],
      "expected_bytes": "b3b3b5b5"
    },
    {
      "//": "Empty object in array encode verification (array: 1 element ‚Üí 0x04, object: 0 pairs ‚Üí 0x00)",
      "name": "encode_empty_object_in_array",
      "type": "encode",
      "input": [
        {}
      ],
      "expected_bytes": "b3b4b5b5"
    },
    {
      "//": "=== Multi-chunk container tests ===",
      "//note": "Chunk length field byte (for small counts) = (count << 2) | (continuation << 1). Continuation=1 means more chunks follow."
    },
    {
      "//": "Multi-chunk array: chunk1 has 2 elements (cont=1), chunk2 has 1 element (cont=0)",
      "//note": "Chunk1: count=2, cont=1 ‚Üí 0x0a. Chunk2: count=1, cont=0 ‚Üí 0x04",
      "name": "decode_multichunk_array_2_1",
      "type": "decode",
      "input_bytes": "b301020395",
      "expected_value": [
        1,
        2,
        3
      ]
    },
    {
      "//": "Multi-chunk array: chunk1 has 1 element (cont=1), chunk2 has 2 elements (cont=0)",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=2, cont=0 ‚Üí 0x08",
      "name": "decode_multichunk_array_1_2",
      "type": "decode",
      "input_bytes": "b301020395",
      "expected_value": [
        1,
        2,
        3
      ]
    },
    {
      "//": "Multi-chunk array: three chunks of 1 element each",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=1, cont=1 ‚Üí 0x06. Chunk3: count=1, cont=0 ‚Üí 0x04",
      "name": "decode_multichunk_array_1_1_1",
      "type": "decode",
      "input_bytes": "b301020395",
      "expected_value": [
        1,
        2,
        3
      ]
    },
    {
      "//": "Multi-chunk array ending with empty final chunk (count=0, cont=0)",
      "//note": "Chunk1: count=2, cont=1 ‚Üí 0x0a. Chunk2: count=0, cont=0 ‚Üí 0x00",
      "name": "decode_multichunk_array_trailing_empty",
      "type": "decode",
      "input_bytes": "b3010295",
      "expected_value": [
        1,
        2
      ]
    },
    {
      "//": "Multi-chunk array: single element then empty final chunk",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=0, cont=0 ‚Üí 0x00",
      "name": "decode_multichunk_array_1_then_empty",
      "type": "decode",
      "input_bytes": "b30195",
      "expected_value": [
        1
      ]
    },
    {
      "//": "Multi-chunk array with mixed value types",
      "//note": "Chunk1: count=2, cont=1 ‚Üí 0x0a (string, int). Chunk2: count=2, cont=0 ‚Üí 0x08 (null, bool)",
      "name": "decode_multichunk_array_mixed_types",
      "type": "decode",
      "input_bytes": "b3666101b0b2b5",
      "expected_value": [
        "a",
        1,
        null,
        true
      ]
    },
    {
      "//": "Multi-chunk object: chunk1 has 1 pair (cont=1), chunk2 has 1 pair (cont=0)",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=1, cont=0 ‚Üí 0x04",
      "name": "decode_multichunk_object_1_1",
      "type": "decode",
      "input_bytes": "b4666101666202b5",
      "expected_value": {
        "a": 1,
        "b": 2
      }
    },
    {
      "//": "Multi-chunk object: chunk1 has 2 pairs (cont=1), chunk2 has 1 pair (cont=0)",
      "//note": "Chunk1: count=2, cont=1 ‚Üí 0x0a. Chunk2: count=1, cont=0 ‚Üí 0x04",
      "name": "decode_multichunk_object_2_1",
      "type": "decode",
      "input_bytes": "b4666101666202666303b5",
      "expected_value": {
        "a": 1,
        "b": 2,
        "c": 3
      }
    },
    {
      "//": "Multi-chunk object ending with empty final chunk (count=0, cont=0)",
      "//note": "Chunk1: count=2, cont=1 ‚Üí 0x0a. Chunk2: count=0, cont=0 ‚Üí 0x00",
      "name": "decode_multichunk_object_trailing_empty",
      "type": "decode",
      "input_bytes": "b4666101666202b5",
      "expected_value": {
        "a": 1,
        "b": 2
      }
    },
    {
      "//": "Multi-chunk object: single pair then empty final chunk",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=0, cont=0 ‚Üí 0x00",
      "name": "decode_multichunk_object_1_then_empty",
      "type": "decode",
      "input_bytes": "b4666101b5",
      "expected_value": {
        "a": 1
      }
    },
    {
      "//": "Multi-chunk object with three chunks",
      "//note": "Chunk1: count=1, cont=1 ‚Üí 0x06. Chunk2: count=1, cont=1 ‚Üí 0x06. Chunk3: count=1, cont=0 ‚Üí 0x04",
      "name": "decode_multichunk_object_1_1_1",
      "type": "decode",
      "input_bytes": "b4666101666202666303b5",
      "expected_value": {
        "a": 1,
        "b": 2,
        "c": 3
      }
    },
    {
      "//": "Multi-chunk nested: outer array in chunks, containing objects",
      "//note": "Outer: chunk1 has 1 elem (cont=1) ‚Üí 0x06, chunk2 has 1 elem (cont=0) ‚Üí 0x04",
      "name": "decode_multichunk_nested_array_of_objects",
      "type": "decode",
      "input_bytes": "b3b4666101b5b4666202b5b5",
      "expected_value": [
        {
          "a": 1
        },
        {
          "b": 2
        }
      ]
    },
    {
      "//": "Multi-chunk nested: outer object in chunks, containing arrays",
      "//note": "Outer: chunk1 has 1 pair (cont=1) ‚Üí 0x06, chunk2 has 1 pair (cont=0) ‚Üí 0x04. Inner arrays: 2 elements ‚Üí 0x08",
      "name": "decode_multichunk_nested_object_of_arrays",
      "type": "decode",
      "input_bytes": "b46661b30102b56662b30304b5b5",
      "expected_value": {
        "a": [
          1,
          2
        ],
        "b": [
          3,
          4
        ]
      }
    },
    {
      "//": "=== Non-canonical length encoding tests ===",
      "//note": "Decoders MUST accept non-canonical (oversized) length encodings"
    },
    {
      "//": "Empty array with non-canonical 2-byte length (payload 0 encoded as 01 00 instead of 00)",
      "name": "noncanonical_length_empty_array_2byte",
      "type": "decode",
      "input_bytes": "b3b5",
      "expected_value": []
    },
    {
      "//": "Array [0] with non-canonical 2-byte length (payload 2 encoded as 09 00 instead of 04)",
      "name": "noncanonical_length_array_1elem_2byte",
      "type": "decode",
      "input_bytes": "b300b5",
      "expected_value": [
        0
      ]
    },
    {
      "//": "Empty array with non-canonical 3-byte length (payload 0 encoded as 03 00 00)",
      "name": "noncanonical_length_empty_array_3byte",
      "type": "decode",
      "input_bytes": "b3b5",
      "expected_value": []
    },
    {
      "//": "Empty object with non-canonical 2-byte length (payload 0 encoded as 01 00 instead of 00)",
      "name": "noncanonical_length_empty_object_2byte",
      "type": "decode",
      "input_bytes": "b4b5",
      "expected_value": {}
    },
    {
      "//": "Object {\"a\": 0} with non-canonical 2-byte length (payload 2 encoded as 09 00 instead of 04)",
      "name": "noncanonical_length_object_1pair_2byte",
      "type": "decode",
      "input_bytes": "b466610095",
      "expected_value": {
        "a": 0
      }
    },
    {
      "//": "Empty object with non-canonical 3-byte length (payload 0 encoded as 03 00 00)",
      "name": "noncanonical_length_empty_object_3byte",
      "type": "decode",
      "input_bytes": "b4b5",
      "expected_value": {}
    },
    {
      "//": "=== Null values in containers ===",
      "//note": "Tests for proper handling of null values inside arrays and objects. Decoders must correctly track container element counts when processing nulls."
    },
    {
      "//": "Array containing multiple null values (2 elements ‚Üí 0x08)",
      "name": "array_of_nulls",
      "type": "encode",
      "input": [
        null,
        null
      ],
      "expected_bytes": "b3b0b0b5"
    },
    {
      "//": "Array with null values interspersed with other types (4 elements ‚Üí 0x10)",
      "name": "array_with_nulls_mixed",
      "type": "encode",
      "input": [
        1,
        null,
        2,
        null
      ],
      "expected_bytes": "b301b002b0b5"
    },
    {
      "//": "Object with multiple null values",
      "name": "object_with_multiple_nulls",
      "type": "roundtrip",
      "input": {
        "a": null,
        "b": null
      }
    },
    {
      "//": "Roundtrip: array of nulls",
      "name": "roundtrip_array_of_nulls",
      "type": "roundtrip",
      "input": [
        null,
        null,
        null
      ]
    },
    {
      "//": "Roundtrip: array with nulls and other values",
      "name": "roundtrip_array_nulls_mixed",
      "type": "roundtrip",
      "input": [
        1,
        null,
        "a",
        null,
        true
      ]
    },
    {
      "//": "Roundtrip: object with null values",
      "name": "roundtrip_object_with_nulls",
      "type": "roundtrip",
      "input": {
        "a": null,
        "b": 1,
        "c": null
      }
    },
    {
      "//": "Roundtrip: nested array containing nulls",
      "name": "roundtrip_nested_array_with_nulls",
      "type": "roundtrip",
      "input": [
        [
          null,
          null
        ],
        [
          null
        ]
      ]
    },
    {
      "//": "Roundtrip: object with nested null values",
      "name": "roundtrip_nested_object_with_nulls",
      "type": "roundtrip",
      "input": {
        "outer": {
          "inner": null
        },
        "also_null": null
      }
    },
    {
      "//": "Roundtrip: complex structure with nulls at various levels",
      "name": "roundtrip_complex_with_nulls",
      "type": "roundtrip",
      "input": {
        "arr": [
          null,
          {
            "nested": null
          }
        ],
        "val": null
      }
    }
  ]
}
