{
  "type": "bonjson-test",
  "version": "1.0.0",
  "//": "BigNumber encoding tests for values that cannot be represented as IEEE 754 floats",
  "//note": "BigNumber roundtrip tests may decode to different types (big.Int, big.Float, float64, string) depending on the implementation. These tests verify the value survives encoding/decoding, not the specific type returned.",
  "tests": [
    {
      "//": "=== BigNumber zero encoding ===",
      "//note": "BigNumber zero has sigLen=0, special value=0 (header byte 0x00)",
      "name": "decode_bignumber_zero",
      "type": "decode",
      "input_bytes": "f100",
      "expected_value": 0
    },
    {
      "//": "=== High precision decimals (roundtrip) ===",
      "//note": "These values exceed float64 precision and require arbitrary precision support to roundtrip"
    },
    {
      "//": "19 significant digits - exceeds float64 precision",
      "name": "roundtrip_bignumber_19_digits",
      "type": "roundtrip",
      "input": {"$number": "1.234567890123456789"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Negative 19-digit decimal",
      "name": "roundtrip_bignumber_neg_19_digits",
      "type": "roundtrip",
      "input": {"$number": "-1.234567890123456789"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "19 digits with negative exponent within common range",
      "name": "roundtrip_bignumber_19_digits_neg_exp",
      "type": "roundtrip",
      "input": {"$number": "1.234567890123456789e-50"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Pi to 19 digits - exceeds float64 precision",
      "name": "roundtrip_bignumber_pi_19",
      "type": "roundtrip",
      "input": {"$number": "3.141592653589793238"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "=== High precision decimals requiring arbitrary precision (roundtrip) ===",
      "//note": "These values have more precision than 64-bit significand can represent"
    },
    {
      "//": "30 significant digits - requires arbitrary precision",
      "name": "bignumber_high_precision",
      "type": "roundtrip",
      "input": {"$number": "1.23456789012345678901234567890"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Very small exponent beyond float64 range",
      "name": "bignumber_tiny_exponent",
      "type": "roundtrip",
      "input": {"$number": "1e-1000"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },
    {
      "//": "Negative exponent within float64 range but high precision",
      "name": "roundtrip_bignumber_30_digits_neg_exp",
      "type": "roundtrip",
      "input": {"$number": "1.23456789012345678901234567890e-50"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Many decimal places",
      "name": "roundtrip_bignumber_many_decimals",
      "type": "roundtrip",
      "input": {"$number": "0.123456789012345678901234567890123456789"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Value that looks like it could be float64 but has too many sig digits",
      "name": "roundtrip_bignumber_looks_like_float",
      "type": "roundtrip",
      "input": {"$number": "3.141592653589793238462643383279"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "=== Negative BigNumber tests ===",
      "//note": "Negative integer within int64 range"
    },
    {
      "name": "roundtrip_bignumber_negative",
      "type": "roundtrip",
      "input": {"$number": "-9007199254740993"}
    },
    {
      "//": "Negative high precision decimal (requires arbitrary precision)",
      "name": "roundtrip_bignumber_negative_decimal",
      "type": "roundtrip",
      "input": {"$number": "-1.23456789012345678901234567890"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Negative with tiny exponent",
      "name": "roundtrip_bignumber_negative_tiny_exponent",
      "type": "roundtrip",
      "input": {"$number": "-1e-500"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },
    {
      "//": "=== BigNumber zero roundtrip ===",
      "name": "roundtrip_bignumber_zero",
      "type": "roundtrip",
      "input": {"$number": "0"}
    },
    {
      "//": "=== BigNumber with negative exponent within common range ===",
      "name": "roundtrip_bignumber_small_neg_exp",
      "type": "roundtrip",
      "input": {"$number": "1.5e-100"}
    },
    {
      "//": "Small value with negative exponent requiring extended range",
      "name": "roundtrip_bignumber_precise_small",
      "type": "roundtrip",
      "input": {"$number": "1.234567890123456789e-200"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },
    {
      "//": "=== Large exponent tests ===",
      "//note": "Values with large exponents that require BigNumber encoding",
      "//note2": "Tests like 1e1000 are removed as they overflow float64 when decoded to interface{}"
    },
    {
      "//": "Large negative exponent",
      "name": "roundtrip_bignumber_large_negative_exponent",
      "type": "roundtrip",
      "input": {"$number": "1e-1000"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },
    {
      "//": "=== Values at float64 boundary ===",
      "//note": "Values that are just beyond float64 precision"
    },
    {
      "name": "roundtrip_bignumber_beyond_float64_precision",
      "type": "roundtrip",
      "input": {"$number": "9007199254740993"}
    },
    {
      "//": "Negative value beyond float64 precision",
      "name": "roundtrip_bignumber_negative_beyond_float64",
      "type": "roundtrip",
      "input": {"$number": "-9007199254740993"}
    },

    {
      "//": "=== BigNumber wire format boundary tests ===",
      "//note": "These test the header structure: [sigLen:5][expLen:2][negative:1]"
    },
    {
      "//": "Negative zero - should preserve sign",
      "name": "decode_bignumber_negative_zero",
      "type": "decode",
      "input_bytes": "f101",
      "expected_value": 0,
      "//note2": "Header 0x01: sigLen=0, expLen=0, negative=1"
    },
    {
      "//": "=== Exponent length boundary tests ===",
      "//note": "expLen=0: zero exponent, expLen=1: 1 byte (-128 to 127), expLen=2: 2 bytes, expLen=3: 4 bytes"
    },
    {
      "//": "Zero exponent (expLen=0): 1e0 = 1",
      "name": "decode_bignumber_zero_exponent",
      "type": "decode",
      "input_bytes": "f10801",
      "expected_value": 1,
      "//note2": "Header 0x08: sigLen=1, expLen=0, negative=0. Significand=0x01"
    },
    {
      "//": "Max 1-byte exponent: 127 (expLen=1)",
      "name": "roundtrip_bignumber_exp_127",
      "type": "roundtrip",
      "input": {"$number": "1e127"}
    },
    {
      "//": "Min 1-byte exponent: -128 (expLen=1)",
      "name": "roundtrip_bignumber_exp_neg128",
      "type": "roundtrip",
      "input": {"$number": "1e-128"}
    },
    {
      "//": "First value requiring 2-byte exponent: 128 (expLen=2)",
      "name": "roundtrip_bignumber_exp_128",
      "type": "roundtrip",
      "input": {"$number": "1e128"},
      "requires": ["bignumber_exponent_gt_127"]
    },
    {
      "//": "First negative value requiring 2-byte exponent: -129 (expLen=2)",
      "name": "roundtrip_bignumber_exp_neg129",
      "type": "roundtrip",
      "input": {"$number": "1e-129"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },
    {
      "//": "Value requiring 2-byte exponent: 200 (expLen=2, beyond 1-byte range)",
      "name": "roundtrip_bignumber_exp_200",
      "type": "roundtrip",
      "input": {"$number": "1e200"},
      "requires": ["bignumber_exponent_gt_127"]
    },
    {
      "//": "Large negative exponent requiring 2-byte encoding: -200 (expLen=2)",
      "name": "roundtrip_bignumber_exp_neg200",
      "type": "roundtrip",
      "input": {"$number": "1e-200"},
      "requires": ["bignumber_exponent_lt_neg128"]
    },

    {
      "//": "=== Significand length boundary tests ===",
      "//note": "sigLen is 5 bits, so max is 31 bytes"
    },
    {
      "//": "Single byte significand (sigLen=1)",
      "name": "decode_bignumber_sig_1_byte",
      "type": "decode",
      "input_bytes": "f108ff",
      "expected_value": 255,
      "//note2": "Header 0x08: sigLen=1. Significand=0xff=255"
    },
    {
      "//": "Two byte significand (sigLen=2)",
      "name": "decode_bignumber_sig_2_bytes",
      "type": "decode",
      "input_bytes": "f110ffff",
      "expected_value": 65535,
      "//note2": "Header 0x10: sigLen=2. Significand=0xffff=65535 (little-endian)"
    },
    {
      "//": "Three byte significand (sigLen=3)",
      "name": "decode_bignumber_sig_3_bytes",
      "type": "decode",
      "input_bytes": "f118010001",
      "expected_value": 65537,
      "//note2": "Header 0x18: sigLen=3. Significand=0x010001=65537 (little-endian)"
    },
    {
      "//": "=== Maximum significand length tests (31 bytes) ===",
      "//note": "sigLen is 5 bits in header, max value is 31"
    },
    {
      "//": "Maximum significand: 31 bytes all 0x01",
      "name": "decode_bignumber_max_siglen_small",
      "type": "decode",
      "//note2": "Header 0xf8: sigLen=31, expLen=0, neg=0. Value = sum(256^i for i=0..30)",
      "input_bytes": "f1f801010101010101010101010101010101010101010101010101010101010101",
      "expected_value": {"$number": "1773775876797123091660094745843871137458179912157484130506396813846708481"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Maximum significand: 31 bytes = 2^248 - 1 (all 0xff)",
      "name": "decode_bignumber_max_siglen_max_value",
      "type": "decode",
      "//note2": "Header 0xf8: sigLen=31, expLen=0, neg=0",
      "input_bytes": "f1f8ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",
      "expected_value": {"$number": "452312848583266388373324160190187140051835877600158453279131187530910662655"},
      "requires": ["arbitrary_precision_bignumber"]
    },
    {
      "//": "Maximum significand with negative flag (31 bytes all 0x01)",
      "name": "decode_bignumber_max_siglen_negative",
      "type": "decode",
      "//note2": "Header 0xf9: sigLen=31, expLen=0, neg=1",
      "input_bytes": "f1f901010101010101010101010101010101010101010101010101010101010101",
      "expected_value": {"$number": "-1773775876797123091660094745843871137458179912157484130506396813846708481"},
      "requires": ["arbitrary_precision_bignumber"]
    }
  ]
}
